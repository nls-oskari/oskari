Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance",function(){this.sandbox=null,this.started=!1,this.buttons={},this.selectedButton=null,this.defaultButton=null,this.container=null,this.menutoolbarcontainer=null,this.containers={},this.toolbars={},this.groupsToToolbars={}},{__name:"Toolbar",getName:function(){return this.__name},setSandbox:function(e){this.sandbox=e},getSandbox:function(){return this.sandbox},update:function(){},start:function(){var e=this;if(e.started)return;e.started=!0;var t=e.conf,n=(t?t.sandbox:null)||"sandbox",r=Oskari.getSandbox(n);r.register(e),e.setSandbox(r);var i=(t?t.defaultToolbarContainer:null)||"#toolbar";this.container=jQuery(i),this.containers["default"]=this.container,this.toolbars["default"]=this.container;var s=(t?t.defaultMenuToolbarContainer:null)||"#menutoolbar",o;this.menutoolbarcontainer=jQuery(s);for(o in e.eventHandlers)e.eventHandlers.hasOwnProperty(o)&&o&&r.registerForEventByName(e,o);r.addRequestHandler("Toolbar.AddToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.RemoveToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.ToolButtonStateRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.SelectToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),r.addRequestHandler("Toolbar.ToolbarRequest",this.requestHandlers.toolbarRequestHandler),r.addRequestHandler("ShowMapMeasurementRequest",this.requestHandlers.showMapMeasurementRequestHandler),r.registerAsStateful(this.mediator.bundleId,this),this._addDefaultButtons&&this._addDefaultButtons()},templates:{group:'<div class="toolrow"></div>',tool:'<div class="tool"></div>',menutoolbar:'<div class="oskari-closed oskariui-menutoolbar"><div class="oskariui-menutoolbar-modetitle"><div class="oskariui-menutoolbar-title"><p></p></div></div><div class="oskariui-menutoolbar-container"><div class="oskariui-menutoolbarbuttongroup"></div></div><div class="oskariui-menutoolbar-closebox"><div class="icon-close-white"></div></div></div>',addedToolbar:'<div class="oskariui-toolbar-title"><p></p></div><div class="oskariui-toolbar-container"><div class="oskariui-toolbarbuttongroup"></div></div>'},init:function(){var e=this;this.templateGroup=jQuery(this.templates.group),this.templateTool=jQuery(this.templates.tool),this.templateMenutoolbar=jQuery(this.templates.menutoolbar),this.requestHandlers={toolButtonRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ToolButtonRequestHandler",e),toolbarRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ToolbarRequestHandler",e),showMapMeasurementRequestHandler:Oskari.clazz.create("Oskari.mapframework.bundle.toolbar.request.ShowMapMeasurementRequestHandler",e)}},createMenuToolbarContainer:function(e,t){var n=t||{},r=this.templateMenutoolbar.clone();this.menutoolbarcontainer.append(r),this.toolbars[e]=r;var i=r.find(".oskariui-menutoolbarbuttongroup");return this.containers[e]=i,n.title&&r.find(".oskariui-menutoolbar-title p").append(n.title),n.show&&r.removeClass("oskari-closed"),n.closeBoxCallback&&r.find(".oskariui-menutoolbar-closebox div").click(n.closeBoxCallback),i},addToolbarContainer:function(e,t){var n=t.toolbarContainer;n.append(jQuery(this.templates.addedToolbar)),this.toolbars[e]=n;var r=n.find(".oskariui-toolbarbuttongroup");return this.containers[e]=r,t.title&&n.find(".oskariui-toolbar-title p").append(t.title),r},changeMenuToolbarTitle:function(e){e&&this.menutoolbarcontainer.find(".oskariui-menutoolbar-title p").html(e)},getToolbarContainer:function(e,t){var n=e||"default",r=this.containers[n];return r===undefined&&this.menutoolbarcontainer&&!t.toolbarContainer?r=this.createMenuToolbarContainer(n,t):(r===undefined||r.parents("body").length===0)&&t&&t.toolbarContainer&&(r=this.addToolbarContainer(n,t)),r},onEvent:function(e){var t=this,n=t.eventHandlers[e.getName()];if(!n)return;return n.apply(this,[e])},measureTools:{basictools:{measureline:!0,measurearea:!0}},eventHandlers:{"Toolbar.ToolSelectedEvent":function(e){var t=this,n=this.getSandbox();if(!t.measureTools[e.getGroupId()])return;if(!t.measureTools[e.getGroupId()][e.getToolId()])return;var r=t.getLocalization("measure").guidance[e.getToolId()];n.request(t,n.getRequestBuilder("ShowMapMeasurementRequest")(r||"",!1,null,null))}},stop:function(){var e=this,t=e.sandbox(),n;for(n in e.eventHandlers)e.eventHandlers.hasOwnProperty(n)&&n&&t.unregisterFromEventByName(e,n);t.removeRequestHandler("ShowMapMeasurementRequest",this.requestHandlers.showMapMeasurementRequestHandler),t.removeRequestHandler("Toolbar.ToolbarRequest",this.requestHandlers.toolbarRequestHandler),t.removeRequestHandler("Toolbar.AddToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.RemoveToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.ToolButtonStateRequest",this.requestHandlers.toolButtonRequestHandler),t.removeRequestHandler("Toolbar.SelectToolButtonRequest",this.requestHandlers.toolButtonRequestHandler),this.sandbox.unregisterStateful(this.mediator.bundleId),e.sandbox.unregister(e),e.started=!1},getLocalization:function(e){return this._localization||(this._localization=Oskari.getLocalization(this.getName())),e?this._localization[e]:this._localization},setState:function(e){if(!e)return;if(e.selected){this.selectedButton=e.selected;var t=e.selected.id,n=e.selected.group,r=this.getToolbarContainer();this._removeToolSelections();var i=r.find("div.toolrow[tbgroup=default-"+n+"]");if(i.length>0){var s=i.find("div.tool[tool="+t+"]");s.length>0&&(s.addClass("selected"),this.buttons[n][t].callback())}}else this.selectedButton=null},getState:function(){var e={};return this.selectedButton&&(e.selected=this.selectedButton),e},_removeToolbar:function(e){var t=this.toolbars[e];t.remove(),this.toolbars[e]=undefined,delete this.toolbars[e]},_showToolbar:function(e){this.toolbars[e].show()},_hideToolbar:function(e){this.toolbars[e].hide()},_addToolbar:function(e,t){this.getToolbarContainer(e,t)}},{protocol:["Oskari.bundle.BundleInstance","Oskari.mapframework.module.Module"]}),define("bundles/framework/bundle/toolbar/instance",function(){}),Oskari.clazz.category("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance","button-methods",{addToolButton:function(e,t,n){if(!e||!t||!n||!n.callback)return;var r=this,i=r.getToolbarContainer(n?n.toolbarid:null,n),s=null,o=(n?n.toolbarid?n.toolbarid:"default":"default")+"-"+t;r.buttons[o]?s=i.find("div.toolrow[tbgroup="+o+"]"):(r.buttons[o]={},s=r.templateGroup.clone(),s.attr("tbgroup",o),i.append(s),r.groupsToToolbars[o]=n?n.toolbarid:null);if(r.buttons[o][e])return;r.buttons[o][e]=n;var u=r.templateTool.clone();u.attr("tool",e),u.attr("title",n.tooltip),u.addClass(n.iconCls),r.selectedButton?r.selectedButton.id===e&&r.selectedButton.group===o&&(u.addClass("selected"),n.callback()):n.selected&&(u.addClass("selected"),r.selectedButton={id:e,group:o}),n.selected&&(r.defaultButton={id:e,group:o}),u.bind("click",function(t){r._clickButton(e,o)}),n.prepend?s.prepend(u):s.append(u),n.disabled===!0&&u.addClass("disabled")},_clickButton:function(e,t){e||(e=this.defaultButton.id,t=this.defaultButton.group);var n=this.buttons[t][e],r,i,s;if(n.enabled==0)return;if(n.sticky==1){var o=this.sandbox.getEventBuilder("Toolbar.ToolSelectedEvent")(e,t);this.sandbox.notifyAll(o),this._removeToolSelections(t),r=this.getToolbarContainer(this.groupsToToolbars[t]),i=r.find("div.toolrow[tbgroup="+t+"]"),s=i.find("div.tool[tool="+e+"]"),s.addClass("selected"),this.selectedButton={id:e,group:t}}n.toggleSelection&&(r=this.getToolbarContainer(this.groupsToToolbars[t]),i=r.find("div.toolrow[tbgroup="+t+"]"),s=i.find("div.tool[tool="+e+"]"),s.hasClass("selected")?s.removeClass("selected"):s.addClass("selected")),n.callback()},_removeToolSelections:function(e){var t=this.getToolbarContainer(this.groupsToToolbars[e]),n=t.find("div.tool");n.removeClass("selected")},removeToolButton:function(e,t,n){if(!t)return;var r=t;n?r=n+"-"+r:r="default-"+r;if(this.buttons[r]){var i=this.getToolbarContainer(this.groupsToToolbars[r]),s=i.find("div.toolrow[tbgroup="+r+"]");if(e){var o=s.find("div.tool[tool="+e+"]");o.remove(),this.buttons[r][e]=null,delete this.buttons[r][e];var u=0,a;for(a in this.buttons[r])this.buttons[r].hasOwnProperty(a)&&u++;u===0&&(s.remove(),this.buttons[r]=null,delete this.buttons[r])}else s.remove(),this.buttons[r]=null,delete this.buttons[r]}},changeToolButtonState:function(e,t,n){if(!t)return;if(this.buttons[t]){var r=this.getToolbarContainer(this.groupsToToolbars[t]),i=r.find("div.toolrow[tbgroup="+t+"]"),s,o,u;if(e)s=i.find("div.tool[tool="+e+"]"),this.buttons[t][e].enabled=n,n?s.removeClass("disabled"):s.addClass("disabled");else{o=i.find("div.tool"),n?o.removeClass("disabled"):o.addClass("disabled");for(u in this.buttons[t])this.buttons[t].hasOwnProperty(u)&&(this.buttons[t][u].enabled=n)}}}}),define("bundles/framework/bundle/toolbar/button-methods",function(){}),Oskari.clazz.category("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance","default-buttons",{_isButtonConfigured:function(e,t){return this.conf&&(this.conf[t]===!1||this.conf[t]&&this.conf[t][e]===!1)?!1:!0},_addDefaultButtons:function(){var e=this,t=this.getLocalization("buttons"),n=this.getSandbox().getRequestBuilder("ToolSelectionRequest"),r="MapModulePlugin.GetFeatureInfoActivationRequest",i=this.getSandbox().getRequestBuilder(r),s,o,u,a,f,l,c,h,p,d,v,m=e.conf?e.getSandbox().getLocalizedProperty(e.conf.mapUrlPrefix):null,g=[{name:"history",buttons:{reset:{iconCls:"tool-reset",tooltip:t.history.reset,sticky:!1,callback:function(){s=e.getSandbox().getRequestBuilder("StateHandler.SetStateRequest"),s&&e.getSandbox().request(e,s()),u=e.getSandbox().getRequestBuilder("ClearHistoryRequest")(),e.getSandbox().request(e,u)}},history_back:{iconCls:"tool-history-back",tooltip:t.history.back,sticky:!1,callback:function(){e.getSandbox().request(e,n("map_control_tool_prev"))}},history_forward:{iconCls:"tool-history-forward",tooltip:t.history.next,sticky:!1,callback:function(){e.getSandbox().request(e,n("map_control_tool_next"))}}}},{name:"basictools",buttons:{zoombox:{iconCls:"tool-zoombox",tooltip:t.zoom,sticky:!0,callback:function(){o="map_control_zoom_tool",e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(o))}},select:{iconCls:"tool-pan",tooltip:t.pan,selected:!0,sticky:!0,callback:function(){o="map_control_navigate_tool",e.getSandbox().request(e,i(!0)),e.getSandbox().request(e,n(o))}},measureline:{iconCls:"tool-measure-line",tooltip:t.measure.line,sticky:!0,callback:function(){o="map_control_measure_tool",e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(o))}},measurearea:{iconCls:"tool-measure-area",tooltip:t.measure.area,sticky:!0,callback:function(){o="map_control_measure_area_tool",e.getSandbox().request(e,i(!1)),e.getSandbox().request(e,n(o))}}}},{name:"viewtools",buttons:{link:{iconCls:"tool-link",tooltip:t.link.tooltip,sticky:!1,callback:function(){a=e.getSandbox().generateMapLinkParameters({showMarker:!0}),f="Oskari.userinterface.component.Popup",l="Oskari.userinterface.component.Button",c=Oskari.clazz.create(f),c.addClass("no_resize"),h=Oskari.clazz.create(l),h.setTitle(t.link.ok),h.addClass("primary"),h.setHandler(function(){o="EnableMapKeyboardMovementRequest",c.close(),e.getSandbox().postRequestByName(o)}),p='<textarea rows="3" cols="80">'+m+a+"</textarea>",o="DisableMapKeyboardMovementRequest",e.getSandbox().postRequestByName(o),c.show(t.link.title,p,[h])}},print:{iconCls:"tool-print",tooltip:t.print.tooltip,sticky:!1,callback:function(){d="location=1,status=1,scrollbars=1,width=850,height=1200",v=window.location.pathname+"?"+e.getSandbox().generateMapLinkParameters()+"&p_p_id=Portti2Map_WAR_portti2mapportlet&p_p_lifecycle=0&p_p_state=exclusive"+"&showMarker=false&forceCache=true&mapmode=print&viewId=2",window.open(v,"Print",d)}}}}];for(group in g){var y=g[group];for(tool in y.buttons)(tool!=="link"||!!m)&&this._isButtonConfigured(tool,y.name)&&this.addToolButton(tool,y.name,y.buttons[tool])}}}),define("bundles/framework/bundle/toolbar/default-buttons",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.AddToolButtonRequest",function(e,t,n){this._id=e,this._group=t,this._config=n},{__name:"Toolbar.AddToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group},getConfig:function(){return this._config}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/AddToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.RemoveToolButtonRequest",function(e,t,n){this._id=e,this._group=t,this._toolbarId=n},{__name:"Toolbar.RemoveToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group},getToolbarId:function(){return this._toolbarId}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/RemoveToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolButtonStateRequest",function(e,t,n){this._id=e,this._group=t,this._state=n==1},{__name:"Toolbar.ToolButtonStateRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group},getState:function(){return this._state}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/ToolButtonStateRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.SelectToolButtonRequest",function(e,t){this._id=e,this._group=t},{__name:"Toolbar.SelectToolButtonRequest",getName:function(){return this.__name},getId:function(){return this._id},getGroup:function(){return this._group}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/SelectToolButtonRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolButtonRequestHandler",function(e){this._toolbar=e},{handleRequest:function(e,t){var n=e.getSandbox();t.getName()=="Toolbar.AddToolButtonRequest"?this._handleAdd(n,t):t.getName()=="Toolbar.RemoveToolButtonRequest"?this._handleRemove(n,t):t.getName()=="Toolbar.ToolButtonStateRequest"?this._handleState(n,t):t.getName()=="Toolbar.SelectToolButtonRequest"&&this._handleClick(n,t)},_handleAdd:function(e,t){this._toolbar.addToolButton(t.getId(),t.getGroup(),t.getConfig())},_handleRemove:function(e,t){this._toolbar.removeToolButton(t.getId(),t.getGroup(),t.getToolbarId())},_handleState:function(e,t){this._toolbar.changeToolButtonState(t.getId(),t.getGroup(),t.getState())},_handleClick:function(e,t){this._toolbar._clickButton(t.getId(),t.getGroup())}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ToolButtonRequestHandler",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ShowMapMeasurementRequestHandler",function(e){var t=this;t._toolbar=e;var n=this._toolbar.getLocalization("measure"),r=n.title;t._title=r,t._dialog=Oskari.clazz.create("Oskari.userinterface.component.Popup"),t._dialog.addClass("oskari-measurement");var i=[],s=Oskari.clazz.create("Oskari.userinterface.component.Button");s.setTitle(n.close),i.push(s),t._buttons=i,t._dialogShown=!1,t._content=null},{handleRequest:function(e,t){var n=e.getSandbox();this._showMeasurementResults(t.getValue())},getValue:function(){return this._value},_showMeasurementResults:function(e){var t=this,n=t._dialog;if(!t._dialogShown){n.show(t._title,"",t._buttons);var r=t._buttons[0];r.setHandler(function(){t._dialogShown=!1;var e=t._toolbar.getSandbox().getRequestBuilder("Toolbar.SelectToolButtonRequest")();t._toolbar.getSandbox().request(t._toolbar,e),t._dialog.close(!0)}),n.moveTo("#toolbar div.toolrow[tbgroup=default-basictools]","top"),t._content=jQuery("<div></div>"),n.setContent(t._content),t._dialogShown=!0}t._content.html(e)}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ShowMapMeasurementRequestHandler",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.event.ToolSelectedEvent",function(e,t){this._toolId=e,this._groupId=t},{__name:"Toolbar.ToolSelectedEvent",getName:function(){return this.__name},getToolId:function(){return this._toolId},getGroupId:function(){return this._groupId}},{protocol:["Oskari.mapframework.event.Event"]}),define("bundles/framework/bundle/toolbar/event/ToolSelectedEvent",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolbarRequest",function(e,t,n){this._id=e,this._op=t,this._data=n},{__name:"Toolbar.ToolbarRequest",getName:function(){return this.__name},getId:function(){return this._id},getOp:function(){return this._op},getData:function(){return this._data}},{protocol:["Oskari.mapframework.request.Request"]}),define("bundles/framework/bundle/toolbar/request/ToolbarRequest",function(){}),Oskari.clazz.define("Oskari.mapframework.bundle.toolbar.request.ToolbarRequestHandler",function(e){this._toolbar=e},{handleRequest:function(e,t){var n=e.getSandbox();t.getOp()=="add"?this._toolbar._addToolbar(t.getId(),t.getData()):t.getOp()=="show"?this._toolbar._showToolbar(t.getId()):t.getOp()=="hide"?this._toolbar._hideToolbar(t.getId()):t.getOp()=="remove"?this._toolbar._removeToolbar(t.getId()):t.getOp()=="changeName"&&this._toolbar.changeMenuToolbarTitle(t.getData())},_handleAdd:function(e,t){this._toolbar.addToolButton(t.getId(),t.getGroup(),t.getConfig())},_handleRemove:function(e,t){this._toolbar.removeToolButton(t.getId(),t.getGroup())},_handleState:function(e,t){this._toolbar.changeToolButtonState(t.getId(),t.getGroup(),t.getState())},_handleClick:function(e,t){this._toolbar._clickButton(t.getId(),t.getGroup())}},{protocol:["Oskari.mapframework.core.RequestHandler"]}),define("bundles/framework/bundle/toolbar/request/ToolbarRequestHandler",function(){}),define("normalize",["require","module"],function(e,t){function o(e,t,n){if(e.indexOf("data:")===0)return e;e=r(e);if(e.match(/^\//)||e.match(s))return e;var i=n.match(s),o=t.match(s);return o&&(!i||i[1]!=o[1]||i[2]!=o[2])?u(e,t):a(u(e,t),n)}function u(e,t){e.substr(0,2)=="./"&&(e=e.substr(2));var n=t.split("/"),r=e.split("/");n.pop();while(curPart=r.shift())curPart==".."?n.pop():n.push(curPart);return n.join("/")}function a(e,t){var n=t.split("/");n.pop(),t=n.join("/")+"/",i=0;while(t.substr(i,1)==e.substr(i,1))i++;while(t.substr(i,1)!="/")i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");out="";while(n.shift())out+="../";while(curPart=r.shift())out+=curPart+"/";return out.substr(0,out.length-1)}var n=/([^:])\/+/g,r=function(e){return e.replace(n,"$1/")},s=/[^\:\/]*:\/\/([^\/])*/,f=function(e,t,n,i){t=r(t),n=r(n);var s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\(\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/ig,u,a,e;while(u=s.exec(e)){a=u[3]||u[2]||u[5]||u[6]||u[4];var f;i&&a.substr(0,1)=="/"?f=i+a:f=o(a,t,n);var l=u[5]||u[6]?1:0;e=e.substr(0,s.lastIndex-a.length-l-1)+f+e.substr(s.lastIndex-l-1),s.lastIndex=s.lastIndex+(f.length-a.length)}return e};return f.convertURIBase=o,f}),define("css",["./normalize"],function(e){function n(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}var t=0;if(typeof window=="undefined")return{load:function(e,t,n){n()}};var r=!1,i=document.getElementsByTagName("head")[0],s=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/),o=!1;!s||(s[1]||s[7]?(o=parseInt(s[1])<6||parseInt(s[7])<=9,s="trident"):s[2]?(o=!0,s="webkit"):s[3]||(s[4]?(o=parseInt(s[4])<18,s="gecko"):r&&alert("Engine detection failed")));var u={},a=/^\/|([^\:\/]*:)/;u.pluginBuilder="./css-builder";var f=[],l={},c=[];u.addBuffer=function(e){if(n(f,e)!=-1)return;if(n(c,e)!=-1)return;f.push(e),c.push(e)},u.setBuffer=function(t,n){var r=window.location.pathname.split("/");r.pop(),r=r.join("/")+"/";var i=require.toUrl("base_url").split("/");i.pop();var s=i.join("/")+"/";s=e.convertURIBase(s,r,"/"),s.match(a)||(s="/"+s),s.substr(s.length-1,1)!="/"&&(s+="/"),u.inject(e(t,s,r));for(var o=0;o<f.length;o++)(n&&f[o].substr(f[o].length-5,5)==".less"||!n&&f[o].substr(f[o].length-4,4)==".css")&&(function(e){l[e]=l[e]||!0,setTimeout(function(){typeof l[e]=="function"&&l[e](),delete l[e]},7)}(f[o]),f.splice(o--,1))},u.attachBuffer=function(e,t){for(var r=0;r<f.length;r++)if(f[r]==e)return l[e]=t,!0;if(l[e]===!0)return l[e]=t,!0;if(n(c,e)!=-1)return t(),!0};var h=function(e,t){setTimeout(function(){for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];if(r.href==e.href)return t()}h(e,t)},10)},p=function(e,t){setTimeout(function(){try{return e.sheet.cssRules,t()}catch(n){}p(e,t)},10)};if(s=="trident"&&o)var d=[],v=[],m=0,g=function(e,t){var n;v.push({url:e,cb:t}),n=d.shift(),!n&&m++<31&&(n=document.createElement("style"),i.appendChild(n)),n&&y(n)},y=function(e){var t=v.shift();if(!t){e.onload=w,d.push(e);return}e.onload=function(){t.cb(t.ss),y(e)};try{var n=e.styleSheet;t.ss=n.imports[n.addImport(t.url)]}catch(r){alert("Got Error:"+r)}};var b=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t},w=function(){};u.linkLoad=function(e,t){var n=setTimeout(function(){r&&alert("timeout"),t()},A*1e3-100),u=function(){clearTimeout(n),a&&(a.onload=w),setTimeout(t,7)};if(!o){var a=b(e);a.onload=u,i.appendChild(a)}else if(s=="webkit"){var a=b(e);h(a,u),i.appendChild(a)}else if(s=="gecko"){var f=document.createElement("style");f.textContent='@import "'+e+'"',p(f,u),i.appendChild(f)}else s=="trident"&&g(e,u)};var E=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],S={},x=function(e,t,n){if(S[e]){t(S[e]);return}var r,i,s;if(typeof XMLHttpRequest!="undefined")r=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){s=E[i];try{r=new ActiveXObject(s)}catch(o){}if(r){E=[s];break}}r.open("GET",e,requirejs.inlineRequire?!1:!0),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):(S[e]=r.responseText,t(r.responseText)))},r.send(null)},T=0,N;u.inject=function(e){T<31&&(N=document.createElement("style"),N.type="text/css",i.appendChild(N),T++),N.styleSheet?N.styleSheet.cssText+=e:N.appendChild(document.createTextNode(e))};var C=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,k=window.location.pathname.split("/");k.pop(),k=k.join("/")+"/";var L=function(t,n,r){t.match(a)||(t="/"+e.convertURIBase(t,k,"/")),x(t,function(i){i=e(i,t,k);var s=[],o=[],u=[],a;while(a=C.exec(i)){var f=a[4]||a[5]||a[7]||a[8]||a[9];s.push(f),o.push(C.lastIndex-a[0].length),u.push(a[0].length)}var l=0;for(var c=0;c<s.length;c++)(function(e){L(s[e],function(t){i=i.substr(0,o[e])+t+i.substr(o[e]+u[e]);var r=t.length-u[e];for(var a=e+1;a<s.length;a++)o[a]+=r;l++,l==s.length&&n(i)},r)})(c);s.length==0&&n(i)},r)};u.normalize=function(e,t){return e.substr(e.length-4,4)==".css"&&(e=e.substr(0,e.length-4)),t(e)};var A,O=!1;return u.load=function(e,t,n,i,s){A=A||i.waitSeconds||7;var a=e+(s?".less":".css");if(u.attachBuffer(a,n))return;var f=t.toUrl(a);!O&&r&&(alert(o?"hacking links":"not hacking"),O=!0),s?L(f,function(e){s&&(e=s(e,function(e){u.inject(e),setTimeout(n,7)}))}):u.linkLoad(f,n)},r&&(u.inspect=function(){if(stylesheet.styleSheet)return stylesheet.styleSheet.cssText;if(stylesheet.innerHTML)return stylesheet.innerHTML}),u}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.addBuffer("resources/framework/bundle/toolbar/css/toolbar.css")}),requirejs.s.contexts._.nextTick=requirejs.nextTick,Oskari.registerLocalization({lang:"fi",key:"Toolbar",value:{buttons:{link:{tooltip:"Linkki",ok:"Ok",title:"Linkki karttanäkymään"},print:{tooltip:"Tulosta"},history:{reset:"Paluu oletusnäkymään",back:"Takaisin",next:"Eteenpäin"},pan:"Liikuta karttaa",zoom:"Lähennä",measure:{line:"Mittaa etäisyys",area:"Mittaa alue"}},measure:{title:"Mittaustulokset",close:"Lopeta",guidance:{measureline:"Osoita mitattava matka kartalta. Lopeta mittaaminen hiiren kaksoisnapautuksella.",measurearea:"Osoita mitattava alue kartalta. Lopeta mittaaminen hiiren kaksoisnapautuksella."}}}}),define("bundles/framework/bundle/toolbar/locale/fi",function(){}),Oskari.registerLocalization({lang:"sv",key:"Toolbar",value:{buttons:{link:{tooltip:"Länk",ok:"Ok",title:"Länk till kartvyn"},print:{tooltip:"Skriv ut"},history:{reset:"Tillbaka till standardvyn",back:"Föregående",next:"Nästa"},pan:"Flytta kartan",zoom:"Zooma in",measure:{line:"Mät avstånd",area:"Mät areal"}},measure:{title:"Mätningsresultat",close:"Avbryt",guidance:{measureline:"Peka ut sträckan som ska mätas på kartan. Sluta mätningen genom att dubbelklicka.",measurearea:"Peka ut området som ska mätas på kartan. Sluta mätningen genom att dubbelklicka."}}}}),define("bundles/framework/bundle/toolbar/locale/sv",function(){}),Oskari.registerLocalization({lang:"en",key:"Toolbar",value:{buttons:{link:{tooltip:"Link",ok:"Ok",title:"Link to map view"},print:{tooltip:"Print"},history:{reset:"Return to default view",back:"Back",next:"Next"},pan:"Pan map view",zoom:"Zoom in",measure:{line:"Measure distance",area:"Measure area"}},measure:{title:"Measurements",close:"Cancel",guidance:{measureline:"Measure a line on the map. Double-click to stop measuring.",measurearea:"Measure an area on the map. Double-click to stop measuring."}}}}),define("bundles/framework/bundle/toolbar/locale/en",function(){}),Oskari.registerLocalization({lang:"cs",key:"Toolbar",value:{buttons:{link:{tooltip:"Odkaz",ok:"Ok",title:"Odkaz na zobrazení mapy"},print:{tooltip:"Tisk"},history:{reset:"Návrat do defaultního zobrazení",back:"Zpět",next:"Další"},pan:"Posunout zobrazení mapy",zoom:"Přiblížit",measure:{line:"Měřit vzdálenost",area:"Měřit plochu"}},measure:{title:"Měření",close:"Storno",guidance:{measureline:"Změřit délku na mapě. Měření ukončíte dvojklikem.",measurearea:"Změřit plochu na mapě. Měření ukončíte dvojklikem."}}}}),define("bundles/framework/bundle/toolbar/locale/cs",function(){}),Oskari.registerLocalization({lang:"de",key:"Toolbar",value:{buttons:{link:{tooltip:"Link",ok:"Ok",title:"Link zur Kartenansicht"},print:{tooltip:"Drucken"},history:{reset:"Zurück zur Standardansicht",back:"Zurück",next:"Weiter"},pan:"Kartenauschnitt verschieben",zoom:"Hereinzoomen",measure:{line:"Entfernung messen",area:"Fläche messen"}},measure:{title:"Messfunktionen",close:"Abbrechen",guidance:{measureline:"Messen Sie eine Linie auf der Karte. Doppelklicken, um die Messung zu beenden.",measurearea:"Messen Sie eine Fläche auf der Karte. Doppelklicken, um die Messung zu beenden."}}}}),define("bundles/framework/bundle/toolbar/locale/de",function(){}),Oskari.registerLocalization({lang:"es",key:"Toolbar",value:{buttons:{link:{tooltip:"Enlace",ok:"Hecho",title:"Enlace a una vista"},print:{tooltip:"Imprimir"},history:{reset:"Volver a la vista inicial",back:"Atrás",next:"Siguiente"},pan:"Desplazar la vista",zoom:"Acercar",measure:{line:"Medir distancia",area:"Medir área"}},measure:{title:"Mediciones",close:"Cancelar",guidance:{measureline:"Medir una línea en el mapa. Doble click para finalizar la medición.",measurearea:"Medir un área en el mapa. Doble click para finalizar la medición."}}}}),define("bundles/framework/bundle/toolbar/locale/es",function(){}),define("src/framework/toolbar/module",["oskari","jquery","bundles/framework/bundle/toolbar/instance","bundles/framework/bundle/toolbar/button-methods","bundles/framework/bundle/toolbar/default-buttons","bundles/framework/bundle/toolbar/request/AddToolButtonRequest","bundles/framework/bundle/toolbar/request/RemoveToolButtonRequest","bundles/framework/bundle/toolbar/request/ToolButtonStateRequest","bundles/framework/bundle/toolbar/request/SelectToolButtonRequest","bundles/framework/bundle/toolbar/request/ToolButtonRequestHandler","bundles/framework/bundle/toolbar/request/ShowMapMeasurementRequestHandler","bundles/framework/bundle/toolbar/event/ToolSelectedEvent","bundles/framework/bundle/toolbar/request/ToolbarRequest","bundles/framework/bundle/toolbar/request/ToolbarRequestHandler","css!resources/framework/bundle/toolbar/css/toolbar.css","bundles/framework/bundle/toolbar/locale/fi","bundles/framework/bundle/toolbar/locale/sv","bundles/framework/bundle/toolbar/locale/en","bundles/framework/bundle/toolbar/locale/cs","bundles/framework/bundle/toolbar/locale/de","bundles/framework/bundle/toolbar/locale/es"],function(e,t){return e.bundleCls("toolbar").category({create:function(){var t=e.clazz.create("Oskari.mapframework.bundle.toolbar.ToolbarBundleInstance");return t},update:function(e,t,n,r){}})}),requirejs.s.contexts._.nextTick=function(e){e()},require(["css"],function(e){e.setBuffer('#toolbar {\r\n  margin-top: 30px;\r\n  width: 100%; }\r\n\r\n#toolbar div.toolrow {\r\n  border-top: 1px solid;\r\n  padding: 0px 10px; }\r\n\r\n#toolbar div.toolrow div.tool {\r\n  display: inline-block;\r\n  cursor: pointer; }\r\n\r\n#toolbar div.toolrow div.tool.selected, #toolbar div.toolrow div.tool:hover:not(.disabled), #toolbar div.toolrow div.tool:active:not(.disabled) {\r\n  background-color: #212121; }\r\n\r\n#toolbar div.toolrow div.tool.disabled, div.tool.disabled {\r\n  cursor: default;\r\n  opacity: 0.25;\r\n  filter: alpha(opacity=25);\r\n  /* For IE8 and earlier, unquote for libsass bug */ }\r\n\r\n.divmanazerpopup.oskari-measurement {\r\n  max-width: 260px; }\r\n\r\n.oskariui-menutoolbar {\r\n  width: 100%;\r\n  height: 36px;\r\n  position: relative;\r\n  background-color: #333;\r\n  height: 40px; }\r\n\r\n.oskariui-menutoolbar div.toolrow {\r\n  padding: 0px 10px; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool {\r\n  display: inline-block;\r\n  cursor: pointer; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool.selected, .oskariui-menutoolbar div.toolrow div.tool:hover:not(.disabled), .oskariui-menutoolbar div.toolrow div.tool:active:not(.disabled) {\r\n  background-color: #212121; }\r\n\r\n.oskariui-menutoolbar div.toolrow div.tool.disabled, div.tool.disabled {\r\n  cursor: default;\r\n  opacity: 0.25;\r\n  filter: alpha(opacity=25);\r\n  /* For IE8 and earlier, unquote for libsass bug */ }\r\n\r\n.oskariui-menutoolbar-container {\r\n  display: inline-block; }\r\n\r\n.oskariui-menutoolbar-modetitle {\r\n  display: inline-block;\r\n  width: 300px; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-closebox {\r\n  position: absolute;\r\n  top: 6px;\r\n  right: 10px; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-closebox div {\r\n  cursor: pointer; }\r\n\r\n.oskariui-menutoolbar .oskariui-menutoolbar-title {\r\n  position: absolute;\r\n  top: 6px; }\r\n\r\ndiv.oskariui-menutoolbar div.oskariui-menutoolbar-title p {\r\n  color: white;\r\n  font: 16px/20px "Open Sans", "Helvetica Neue", "HelveticaNeue", Helvetica, Arial, sans-serif; }\r\n')}),requirejs.s.contexts._.nextTick=requirejs.nextTick;